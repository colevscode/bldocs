{{$meta}}
type: guide
title: Preprocessors
order: 4
{{$endmeta}}

{{$layout /index.html as content}}

After your changes are uploaded via Dropbox, Backlift will run preprocessors on certain files and optionally optimize your javascript and css. This happens automatically, but you can control what files are processed.

## Preprocessing

During the preprocessing phase, files with known extensions are compiled into html, javascript or css. The following is a list of the known file extensions, the type of file generated, and the associated preprocessor:

* \*.md --&gt; .html (processed with the [python markdown](http://pythonhosted.org/Markdown/) module)
* \*.sass/.scss --&gt; .css (processed using the [compass](http://compass-style.org/) compiler)
* \*.less --&gt; .css ([less](http://lesscss.org/) compiler)
* \*.coffee --&gt; .js ([coffeescript](http://coffeescript.org/) compiler)
* \*.jst --&gt; .js ([underscore template](http://underscorejs.org/#template) compiler)
* \*.handlebars --&gt; .js ([handlebars](http://handlebarsjs.com/) template compiler)

You can control which files are passed to the compilers by adding a `compile` directive to your project's config.yml file. The compile directive should include a list of files that will be compiled. The default, if no compile directive is specified, includes the following:

<pre><code class="no-highlight">compile:
- /**/*.md
- /**/*.scss
- /**/*.sass
- /**/bootstrap*.less
- /**/*.coffee
- /**/*.handlebars
- /**/*.jst
</code></pre>

(Note that only the main bootstrap.less file will typically be compiled. This is because the bootstrap.less file imports several .less components. Attempting to pass those component .less files directly to the less compiler will result in an error.)

Typically it will not be necessary to adjust the compile configuration. If no files of a particular kind exist, the compiler for that file type will not be invoked.

### Using preprocessor results

There are a couple of ways to automatically detect new files and incorporate them into your HTML.

You can use the [Backlift Files API??]() to query a folder in your project for the relevant HTML files generated by the markdown preprocessor. 

Also, you can use the {{$&nbsp;scripts&nbsp;}} and {{$&nbsp;styles&nbsp;}} template tags along with the scripts and styles properties in your config.yml file to automatically discover new files generated by the preprocessors.

### Using underscore or handlebars templates in your JavaScript

The scripts generated by the Underscore template compiler include code that adds the template to a global JST object. To use the template, simply call the function with the same name as the original template file, and pass it the template parameters to be rendered. For example, the file "profile.jst" will create a profile template function that can be used like so:

	var rendered = JST.profile({username: "Cole", hometown: "San Francisco"});
	$("#profile-div").html(rendered);

To use the scripts generated by the handlebars compiler, see the [handlebars documentation](http://handlebarsjs.com/). You will need to include the handlebars.js script in your config.yml scripts list. Here is an example of a "profile.handlebars" template in use:

	var rendered = Handlebars.templates.profile({
		username: "Cole",
		hometown: "San Francisco"
	});
	$("#profile-div").html(rendered);

## Optimization

After the preprocessor has converted your files, Backlift will optionally optimize your files. During the optimization phase, javascript and css files are concatenated and minified. Optimization can be enabled or disabled using the `optimize` setting within config.yml.

	optimize: on

By default optimization is disabled. This reduces the time required to build your webapp, and avoides the obscure code generated by minification. Optimization should not be used during development.

Backlift uses the YUI compressor to minify and concatenate javascript and css files. The optimizer will generate two files, `\public\optimized-scripts.js` and `\public\optmized-styles.css`. The {{$&nbsp;scripts&nbsp;}} and {{$&nbsp;styles&nbsp;}} Backlift variables will include only these two files if the optimizer is enabled.

